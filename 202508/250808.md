# 📆 2025-08-08 (금)
## 🥅 오늘 목표 
- [x] 운영툴 패키지 작업 
- [ ] 기술 블로그 글 쓰기 
- [ ] 랠릿 정리 
- [x] 메인 페이지 베스트 영역 쿼리 성능 개선

## ☑️ 오늘 한 일 📑 ( 목표하지 않았지만 추가된 것들 )

***

## 🔍️ 오늘 무엇을 했나요? Review
### [WORK] 메인 페이지 베스트 영역 쿼리 성능 개선 
메인 페이지에서 베스트 영역만 느리게 뜨는 이슈가 있었다. 메인 페이지 자체를 개편할 계획이었기 때문에 코드를 수정하는 방향보다는 당장 할 수 있는 조치를 하기로 했다. 
실행 계획(`EXPLAIN ANALYZE`) 분석 결과, 주요 병목 지점은 다음과 같음.

1. **프로모션 테이블**

   * 조건에 맞는 데이터 조회 시
     **Parallel Seq Scan** 발생 → 전체 50만 건 이상 스캔
   * 동일 쿼리 반복 시에도 인덱스 미활용 → 부하 급증

2. **이미지 테이블**

   * 최신 이미지 조회를 위해
     동일 product\_id 범위 내 서브쿼리 반복 실행
   * 인덱스는 있었으나 최신값 조회 최적화 미흡
#### 조치 내용

##### (1) 프로모션 테이블 복합 인덱스 추가


* **Before**: Parallel Seq Scan → 519,249행 스캔
* **After**: Index Scan → 조건에 맞는 1행만 즉시 조회

---

##### (2) 이미지 테이블 최신 생성일 조회 인덱스 추가

* **Before**: 최신일자 서브쿼리 반복 실행
* **After**: Index Only Scan → 최신 생성일 즉시 조회 (Heap Fetch 최소화)

#### 성능 비교

| 구분                            | **Before (인덱스 추가 전)**                                       | **After (인덱스 적용 후)**                    | 변화 효과              |
| ----------------------------- | ----------------------------------------------------------- | --------------------------------------- | ------------------ |
| **Execution Time**            | **1,809.318 ms**                                            | **1.101 ms**                            | 약 **99.94% 속도 개선** |
| **프로모션 접근**    | `Parallel Seq Scan` 발생<br> - 519,249행 스캔<br> - 조건 필터로 대량 제거 | `Index Scan` 사용<br> - 1행만 조회            | **병목 제거**          |
| **이미지 최신 생성일 조회** | 서브쿼리 반복 실행<br> - 인덱스 일부 활용                                  | `Index Only Scan` 사용<br> - 최신 생성일 바로 조회 | 서브쿼리 부하 제거         |
| **join 구조**                   | 이미 인덱스 최적화 상태                                               | 동일                                      | 변화 없음              |
| **전체 쿼리 I/O**                 | 대량 Seq Scan + CPU 부하                                        | 모든 접근 Index Scan                        | 로드 안정화             |

---

#### 최종 결과

* **응답 속도**: 1.8초 → **1.1ms**
* **트래픽 변동 시 안정성 확보**: 인덱스 기반 조회로 성능 변동 최소화
* **DB 부하 완화**: CPU·디스크 I/O 대폭 감소

***

## 💡 오늘 회고
메인 페이지 베스트 영역은 사실 예전부터 느리다고 말이 나왔었는데, 왜 그때 인덱스 추가 안하고 버팅겼는지 모르겠다. 
과거의 나도 참, 나다라는 생각이 들면서 이런 일들이 있을 때마다 드는 생각은 그래도 전보다 내가 나아졌다는 증거군!이렇게 생각을 더 한다. 긍정으로 생각해버리기! 

월욜부터 컨디션이 안좋긴 했는데 목욜부터 정점을 찍었다. 오늘은 아침에 일어나자마자 인후가 부은 느낌이 들었다. 
이 쎄한 느낌 어디서 느껴봤는데... 근데 오늘 주간회고 동료의 글에 또로나에 걸렸었다고 쓰여있었다.. 아니 그걸 왜 이제야? 
설마 아니겠지..ㅎ.. 아닐거야 그냥 피곤해서 단순일거야 (두통을 참으며..) 운동으로 이겨내보갓으.. 

지금은 운영 관리에 쓰이는 툴 작업을 하고 있다. 기본 틀은 다 완성을 했고, 이제 UX적인 부분을 작업하고 있는데, 프론트는 주력이 아니다보니 더디다. 오늘 안에 끝내기를 목표 잡았는데, 디테일 신경쓰면 좀 더 걸릴 것 같다 

이제 다음주부터 스터디가 시작되고 8월에는 내 나름의 폭풍같은 것들이 기다리고 있는데 무섭다. 태풍이 지나고 나면 깨끗해지듯 내 일상도 평화로워졌으면 (원하는거 다 이루어져라 제발)


## 🎯 내일 할 일
- [ ] 랠릿 정리 
- [ ] 기술블로그 이젠 써야지? 

***

## 🏁 이번주 목표 🏁
- [x] 패키지 작업 
- [x] 랠릿, 깃블로그 이력서 등 내가 한 일에 대한 업데이트 
- [x] 강의, 책, 사이드 프로젝트 등 무언가 꾸준히 실행하기 
